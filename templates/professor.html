    // FUNÇÃO CORRIGIDA PARA ENVIAR ALERTA
    async function enviarAlerta(){
        const teacher = document.getElementById('teacher').value.trim();
        const room = document.getElementById('room').value.trim();
        const desc = document.getElementById('description').value.trim();
        const statusEl = document.getElementById('status');
        const logBox = document.getElementById('logBox');

        if (!room || !desc){
            statusEl.textContent = "Preencha ao menos Sala/Nº da Turma e a Descrição do Problema.";
            statusEl.style.background = "rgba(239, 68, 68, 0.2)";
            statusEl.style.color = "#fca5a5";
            statusEl.style.border = "1px solid rgba(239, 68, 68, 0.3)";
            return;
        }
        
        statusEl.textContent = "Enviando alerta...";
        statusEl.style.background = "rgba(59, 130, 246, 0.2)";
        statusEl.style.color = "#93c5fd";
        statusEl.style.border = "1px solid rgba(59, 130, 246, 0.3)";

        try{
            // ✅ CORREÇÃO: Usando a rota correta com POST
            const resp = await fetch('/api/alert', {
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body:JSON.stringify({ 
                    teacher: teacher || 'Professor', 
                    room: room, 
                    description: desc 
                })
            });
            
            const data = await resp.json();
            
            if(data.ok){
                statusEl.textContent = "✅ Alerta enviado com sucesso para o Painel Central.";
                statusEl.style.background = "rgba(34, 197, 94, 0.2)";
                statusEl.style.color = "#86efac";
                statusEl.style.border = "1px solid rgba(34, 197, 94, 0.3)";
                
                const now = new Date().toLocaleTimeString('pt-BR',{hour12:false});
                const line = `[${now}] Alerta enviado - Sala: ${room} | Desc: ${desc}`;
                
                if (logBox.textContent.includes("Nenhum alerta")){
                    logBox.textContent = line;
                } else {
                    logBox.textContent = line + "\n" + logBox.textContent;
                }
                
                // Tocar sirene automaticamente
                try {
                    const audio = new Audio('/tocar_sirene');
                    audio.volume = 0.3;
                    await audio.play();
                } catch (audioError) {
                    console.log('Sirene não pôde ser reproduzida:', audioError);
                }
                
            } else {
                statusEl.textContent = "Falha ao enviar alerta: " + (data.error || 'Erro desconhecido');
                statusEl.style.background = "rgba(239, 68, 68, 0.2)";
                statusEl.style.color = "#fca5a5";
                statusEl.style.border = "1px solid rgba(239, 68, 68, 0.3)";
            }
        } catch(e){
            console.error('Erro completo:', e);
            statusEl.textContent = "Erro de comunicação com o servidor: " + e.message;
            statusEl.style.background = "rgba(239, 68, 68, 0.2)";
            statusEl.style.color = "#fca5a5";
            statusEl.style.border = "1px solid rgba(239, 68, 68, 0.3)";
        }
    }

    // ✅ CORREÇÃO: Event listeners corrigidos
    document.getElementById('btnAlertar').addEventListener('click', enviarAlerta);

    document.getElementById('btnReiniciar').addEventListener('click', () => {
        document.getElementById('teacher').value = "";
        document.getElementById('room').value = "";
        document.getElementById('description').value = "";
        document.getElementById('status').textContent = "";
        document.getElementById('status').style.background = "transparent";
        document.getElementById('status').style.border = "none";
    });

    document.getElementById('btnLimpar').addEventListener('click', () => {
        document.getElementById('status').textContent = "";
        document.getElementById('status').style.background = "transparent";
        document.getElementById('status').style.border = "none";
        document.getElementById('logBox').textContent = "Nenhum alerta enviado ainda.";
    });

    document.getElementById('btnSair').addEventListener('click', () => {
        window.location.href = '/';
    });

    function updateClock(){
        const el = document.getElementById('clock');
        const now = new Date();
        el.textContent = now.toLocaleTimeString('pt-BR',{hour12:false});
    }
    setInterval(updateClock,1000);
    updateClock();
